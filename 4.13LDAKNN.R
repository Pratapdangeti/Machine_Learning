


rm(list = ls())


library(ISLR)
library(MASS)
library(class)
fix(Boston)
attach(Boston)
dim(Boston)
#> dim(Boston)
# [1] 506  14
names(Boston)
str(Boston)
cor(Boston)
train = sample()
#[1] "crim"    "zn"      "indus"   "chas"    "nox"     "rm"      "age"     "dis"     "rad"    
#[10] "tax"     "ptratio" "black"   "lstat"   "medv"   

crim01=rep(1,506)
crim01[crim<median(crim)]=0

crim01
Boston_n=data.frame(Boston,crim01)
cor(Boston_n)

#            crim          zn       indus         chas         nox          rm         age         dis          rad         tax    ptratio       black      lstat       medv         
#crim     1.00000000 -0.20046922  0.40658341 -0.055891582  0.42097171 -0.21924670  0.35273425 -0.37967009  0.625505145  0.58276431  0.2899456 -0.38506394  0.4556215 -0.3883046
#zn      -0.20046922  1.00000000 -0.53382819 -0.042696719 -0.51660371  0.31199059 -0.56953734  0.66440822 -0.311947826 -0.31456332 -0.3916785  0.17552032 -0.4129946  0.3604453
#indus    0.40658341 -0.53382819  1.00000000  0.062938027  0.76365145 -0.39167585  0.64477851 -0.70802699  0.595129275  0.72076018  0.3832476 -0.35697654  0.6037997 -0.4837252
#chas    -0.05589158 -0.04269672  0.06293803  1.000000000  0.09120281  0.09125123  0.08651777 -0.09917578 -0.007368241 -0.03558652 -0.1215152  0.04878848 -0.0539293  0.1752602
#nox      0.42097171 -0.51660371  0.76365145  0.091202807  1.00000000 -0.30218819  0.73147010 -0.76923011  0.611440563  0.66802320  0.1889327 -0.38005064  0.5908789 -0.4273208
#rm      -0.21924670  0.31199059 -0.39167585  0.091251225 -0.30218819  1.00000000 -0.24026493  0.20524621 -0.209846668 -0.29204783 -0.3555015  0.12806864 -0.6138083  0.6953599
#age      0.35273425 -0.56953734  0.64477851  0.086517774  0.73147010 -0.24026493  1.00000000 -0.74788054  0.456022452  0.50645559  0.2615150 -0.27353398  0.6023385 -0.3769546
#dis     -0.37967009  0.66440822 -0.70802699 -0.099175780 -0.76923011  0.20524621 -0.74788054  1.00000000 -0.494587930 -0.53443158 -0.2324705  0.29151167 -0.4969958  0.2499287
#rad      0.62550515 -0.31194783  0.59512927 -0.007368241  0.61144056 -0.20984667  0.45602245 -0.49458793  1.000000000  0.91022819  0.4647412 -0.44441282  0.4886763 -0.3816262
#tax      0.58276431 -0.31456332  0.72076018 -0.035586518  0.66802320 -0.29204783  0.50645559 -0.53443158  0.910228189  1.00000000  0.4608530 -0.44180801  0.5439934 -0.4685359
#ptratio  0.28994558 -0.39167855  0.38324756 -0.121515174  0.18893268 -0.35550149  0.26151501 -0.23247054  0.464741179  0.46085304  1.0000000 -0.17738330  0.3740443 -0.5077867
#black   -0.38506394  0.17552032 -0.35697654  0.048788485 -0.38005064  0.12806864 -0.27353398  0.29151167 -0.444412816 -0.44180801 -0.1773833  1.00000000 -0.3660869  0.3334608
#lstat    0.45562148 -0.41299457  0.60379972 -0.053929298  0.59087892 -0.61380827  0.60233853 -0.49699583  0.488676335  0.54399341  0.3740443 -0.36608690  1.0000000 -0.7376627
#medv    -0.38830461  0.36044534 -0.48372516  0.175260177 -0.42732077  0.69535995 -0.37695457  0.24992873 -0.381626231 -0.46853593 -0.5077867  0.33346082 -0.7376627  1.0000000
#crim01   0.40939545 -0.43615103  0.60326017  0.070096774  0.72323480 -0.15637178  0.61393992 -0.61634164  0.619786249  0.60874128  0.2535684 -0.35121093  0.4532627 -0.2630167


#          crim01
#crim     0.40939545
#zn      -0.43615103
#indus    0.60326017
#chas     0.07009677
#nox      0.72323480
#rm      -0.15637178
#age      0.61393992
#dis     -0.61634164
#rad      0.61978625
#tax      0.60874128
#ptratio  0.25356836
#black   -0.35121093
#lstat    0.45326273
#medv    -0.26301673
#crim01   1.00000000


# a -  removing due to less corelation with zn,chas,rm,ptratio,black

x= Boston_n[,-c(1,2,4,6,11,12)]
y = Boston_n[,15]
head(x)

set.seed(3)
train = sample(1:nrow(x),350,replace = FALSE)


Boston_train = x[train,]
Boston_test = x[-train,]

dim(Boston_train)
#[1] 350   9
dim(Boston_test)
#[1] 156   9

crim_train = crim01[train]
crim_test = crim01[-train]

# logistic regression
names(Boston_train)
glm.fit = glm(crim01~indus+nox+age+dis+rad+tax+lstat+medv,family = binomial,data = Boston_train)
glm.probs = predict(glm.fit,Boston_test,type = "response")
glm.predict = rep(1,156)
glm.predict[glm.probs<0.5]=0

table(glm.predict,crim_test)
#           crim_test
#glm.predict  0  1
#          0 79 16
#          1  4 57

# error % = 12.82 %

# LDA
lda.fit = lda(crim01~indus+nox+age+dis+rad+tax+lstat+medv,data = Boston_train)
lda.predict = predict(lda.fit,Boston_test)

lda.class = lda.predict$class
table(lda.class,crim_test)

#         crim_test
#lda.class  0  1
#        0 80 19
#        1  3 54

# error % - 14.1%


# KNN

names(Boston_train)
KNNBoston_train = Boston_train[,-9]
KNNBoston_test = Boston_test[,-9]
knn.fit = knn(KNNBoston_train,KNNBoston_test,crim_train,k=3)

table(knn.fit,crim_test)

#       crim_test
#knn.fit  0  1
#      0 75  7
#      1  8 66

# error% = 9.6%

#      crim_test
#knn.fit  0  1
#      0 78  7
#      1  5 66
# error % = 7.6%




















